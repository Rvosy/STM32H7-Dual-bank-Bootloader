#ifndef __BOOT_CORE_H
#define __BOOT_CORE_H

#include <stdint.h>

/*============================================================================
 * 常量定义
 *============================================================================*/

#define BOOT_MAGIC        0xB007A55Au   /* Boot 跳转标志魔数 */

/*============================================================================
 * 外部变量声明
 *============================================================================*/

/* 跨软复位保持的变量，放置在 DTCM RAM 固定地址 */
extern uint32_t g_JumpInit;

/*============================================================================
 * 函数声明
 *============================================================================*/

/**
 * @brief  选择最佳镜像并跳转
 * @note   此函数不会返回
 *         - 如果需要 Bank Swap，会触发系统复位
 *         - 如果无需 Swap，会设置跳转标志并软复位
 *         - 如果没有有效镜像，进入 DFU 模式
 */
void Boot_SelectAndJump(void);

/**
 * @brief  跳转到 App (在外设初始化之前调用，状态干净)
 * @note   此函数不会返回
 *         应在检测到 g_JumpInit == BOOT_MAGIC 后立即调用
 */
void Boot_JumpToApp(void);

/**
 * @brief  检查是否应该立即跳转到 App
 * @retval 1=应该跳转, 0=不应该跳转
 */
int Boot_ShouldJump(void);


#endif /* __BOOT_CORE_H */
